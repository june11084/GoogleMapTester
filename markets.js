// import myJSON from 'lovely_list.js';
// console.log(myJSON)

let marketJSON = {
"status": "success",
"message": "asdf",
"markets": [
{
"id": 1,
"market": "aberdeen",
"state_id": 33,
"latitude": "35.131547",
"longitude": "-79.429479",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:07:55",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:07:55",
"deleted_at": null,
"inventory_phrases": [
{
"id": 40,
"inventory_market_id": 1,
"phrase": "aberdeen houses for sale",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:21",
"updated_at": "2018-05-22 19:03:05",
"deleted_at": null
},
{
"id": 45,
"inventory_market_id": 1,
"phrase": "houses for sale in aberdeen",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:21",
"updated_at": "2018-05-22 19:03:06",
"deleted_at": null
},
{
"id": 52,
"inventory_market_id": 1,
"phrase": "properties aberdeen",
"search_rate": 1600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:22",
"updated_at": "2018-05-22 19:03:06",
"deleted_at": null
},
{
"id": 75,
"inventory_market_id": 1,
"phrase": "aberdeen property",
"search_rate": 1600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:24",
"updated_at": "2018-05-22 19:03:09",
"deleted_at": null
},
{
"id": 51,
"inventory_market_id": 1,
"phrase": "properties in aberdeen",
"search_rate": 1600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:22",
"updated_at": "2018-05-22 19:03:06",
"deleted_at": null
}
],
"state": {
"id": 33,
"name": "North Carolina",
"abbreviation": "NC",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "37",
"assoc_press": "N.C.",
"standard_federal_region": "IV",
"census_region": "3",
"census_region_name": "South",
"census_division": "5",
"census_division_name": "South Atlantic",
"circuit_court": "4"
}
},
{
"id": 2,
"market": "abilene",
"state_id": 43,
"latitude": "32.448736",
"longitude": "-99.733144",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:07:55",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:07:55",
"deleted_at": null,
"inventory_phrases": [
{
"id": 99,
"inventory_market_id": 2,
"phrase": "abilene Texas homes for sale",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:27",
"updated_at": "2018-05-22 19:03:11",
"deleted_at": null
},
{
"id": 98,
"inventory_market_id": 2,
"phrase": "abilene TX homes for sale",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:27",
"updated_at": "2018-05-22 19:03:11",
"deleted_at": null
},
{
"id": 101,
"inventory_market_id": 2,
"phrase": "homes for sale abilene TX",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:27",
"updated_at": "2018-05-22 19:03:11",
"deleted_at": null
},
{
"id": 102,
"inventory_market_id": 2,
"phrase": "homes for sale abilene Texas",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:27",
"updated_at": "2018-05-22 19:03:11",
"deleted_at": null
},
{
"id": 103,
"inventory_market_id": 2,
"phrase": "homes for sale in abilene TX",
"search_rate": 3600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:27",
"updated_at": "2018-05-22 19:03:12",
"deleted_at": null
}
],
"state": {
"id": 43,
"name": "Texas",
"abbreviation": "TX",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "48",
"assoc_press": "Texas",
"standard_federal_region": "VI",
"census_region": "3",
"census_region_name": "South",
"census_division": "7",
"census_division_name": "West South Central",
"circuit_court": "5"
}
},
{
"id": 3,
"market": "abington",
"state_id": 38,
"latitude": "40.124080",
"longitude": "-75.119511",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:07:55",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:07:55",
"deleted_at": null,
"inventory_phrases": [
{
"id": 198,
"inventory_market_id": 3,
"phrase": "abington properties",
"search_rate": 1600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:38",
"updated_at": "2018-05-22 19:03:21",
"deleted_at": null
},
{
"id": 225,
"inventory_market_id": 3,
"phrase": "abington property",
"search_rate": 1600,
"in_stock": 1,
"created_at": "2018-05-22 17:15:41",
"updated_at": "2018-05-22 19:03:24",
"deleted_at": null
},
{
"id": 177,
"inventory_market_id": 3,
"phrase": "homes for sale abington Pennsylvania",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:15:36",
"updated_at": "2018-05-22 19:03:19",
"deleted_at": null
},
{
"id": 173,
"inventory_market_id": 3,
"phrase": "abington PA homes for sale",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:15:35",
"updated_at": "2018-05-22 19:03:19",
"deleted_at": null
},
{
"id": 178,
"inventory_market_id": 3,
"phrase": "homes for sale in abington PA",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:15:36",
"updated_at": "2018-05-22 19:03:19",
"deleted_at": null
}
],
"state": {
"id": 38,
"name": "Pennsylvania",
"abbreviation": "PA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "42",
"assoc_press": "Pa.",
"standard_federal_region": "III",
"census_region": "1",
"census_region_name": "Northeast",
"census_division": "2",
"census_division_name": "Mid-Atlantic",
"circuit_court": "3"
}
},
{
"id": 4,
"market": "absarokee",
"state_id": 26,
"latitude": "45.520498",
"longitude": "-109.442944",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:07:55",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:07:55",
"deleted_at": null,
"inventory_phrases": [
{
"id": 254,
"inventory_market_id": 4,
"phrase": "homes for sale in absarokee Montana",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:15:45",
"updated_at": "2018-05-22 19:03:28",
"deleted_at": null
},
{
"id": 227,
"inventory_market_id": 4,
"phrase": "real estate absarokee Montana",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:15:41",
"updated_at": "2018-05-22 19:03:24",
"deleted_at": null
},
{
"id": 235,
"inventory_market_id": 4,
"phrase": "absarokee MT real estate",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:15:42",
"updated_at": "2018-05-22 19:03:26",
"deleted_at": null
},
{
"id": 236,
"inventory_market_id": 4,
"phrase": "absarokee Montana real estate",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:15:42",
"updated_at": "2018-05-22 19:03:26",
"deleted_at": null
},
{
"id": 248,
"inventory_market_id": 4,
"phrase": "absarokee MT homes for sale",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:15:44",
"updated_at": "2018-05-22 19:03:27",
"deleted_at": null
}
],
"state": {
"id": 26,
"name": "Montana",
"abbreviation": "MT",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "30",
"assoc_press": "Mont.",
"standard_federal_region": "VIII",
"census_region": "4",
"census_region_name": "West",
"census_division": "8",
"census_division_name": "Mountain",
"circuit_court": "9"
}
},
{
"id": 5,
"market": "acton",
"state_id": 21,
"latitude": "42.485093",
"longitude": "-71.432840",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:07:55",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:07:55",
"deleted_at": null,
"inventory_phrases": [
{
"id": 312,
"inventory_market_id": 5,
"phrase": "acton real estate",
"search_rate": 2400,
"in_stock": 1,
"created_at": "2018-05-22 17:15:51",
"updated_at": "2018-05-22 19:03:33",
"deleted_at": null
},
{
"id": 303,
"inventory_market_id": 5,
"phrase": "real estate acton",
"search_rate": 2400,
"in_stock": 1,
"created_at": "2018-05-22 17:15:50",
"updated_at": "2018-05-22 19:03:33",
"deleted_at": null
},
{
"id": 340,
"inventory_market_id": 5,
"phrase": "acton houses for sale",
"search_rate": 2400,
"in_stock": 1,
"created_at": "2018-05-22 17:15:55",
"updated_at": "2018-05-22 19:03:37",
"deleted_at": null
},
{
"id": 325,
"inventory_market_id": 5,
"phrase": "acton homes for sale",
"search_rate": 2400,
"in_stock": 1,
"created_at": "2018-05-22 17:15:52",
"updated_at": "2018-05-22 19:03:35",
"deleted_at": null
},
{
"id": 330,
"inventory_market_id": 5,
"phrase": "homes for sale in acton",
"search_rate": 2400,
"in_stock": 1,
"created_at": "2018-05-22 17:15:54",
"updated_at": "2018-05-22 19:03:36",
"deleted_at": null
}
],
"state": {
"id": 21,
"name": "Massachusetts",
"abbreviation": "MA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "25",
"assoc_press": "Mass.",
"standard_federal_region": "I",
"census_region": "1",
"census_region_name": "Northeast",
"census_division": "1",
"census_division_name": "New England",
"circuit_court": "1"
}
},
{
"id": 6,
"market": "acworth",
"state_id": 10,
"latitude": "34.065933",
"longitude": "-84.676880",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:07:55",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:07:55",
"deleted_at": null,
"inventory_phrases": [
{
"id": 402,
"inventory_market_id": 6,
"phrase": "homes for sale acworth Georgia",
"search_rate": 1900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:02",
"updated_at": "2018-05-22 19:03:43",
"deleted_at": null
},
{
"id": 399,
"inventory_market_id": 6,
"phrase": "acworth Georgia homes for sale",
"search_rate": 1900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:02",
"updated_at": "2018-05-22 19:03:43",
"deleted_at": null
},
{
"id": 398,
"inventory_market_id": 6,
"phrase": "acworth GA homes for sale",
"search_rate": 1900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:02",
"updated_at": "2018-05-22 19:03:43",
"deleted_at": null
},
{
"id": 401,
"inventory_market_id": 6,
"phrase": "homes for sale acworth GA",
"search_rate": 1900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:02",
"updated_at": "2018-05-22 19:03:43",
"deleted_at": null
},
{
"id": 403,
"inventory_market_id": 6,
"phrase": "homes for sale in acworth GA",
"search_rate": 1900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:03",
"updated_at": "2018-05-22 19:03:44",
"deleted_at": null
}
],
"state": {
"id": 10,
"name": "Georgia",
"abbreviation": "GA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "13",
"assoc_press": "Ga.",
"standard_federal_region": "IV",
"census_region": "3",
"census_region_name": "South",
"census_division": "5",
"census_division_name": "South Atlantic",
"circuit_court": "11"
}
},
{
"id": 7,
"market": "ada",
"state_id": 22,
"latitude": "42.960727",
"longitude": "-85.495480",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:09:13",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:09:13",
"deleted_at": null,
"inventory_phrases": [
{
"id": 477,
"inventory_market_id": 7,
"phrase": "homes for sale ada Michigan",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:12",
"updated_at": "2018-05-22 19:08:29",
"deleted_at": null
},
{
"id": 478,
"inventory_market_id": 7,
"phrase": "homes for sale in ada MI",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:12",
"updated_at": "2018-05-22 19:08:30",
"deleted_at": null
},
{
"id": 473,
"inventory_market_id": 7,
"phrase": "ada MI homes for sale",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:12",
"updated_at": "2018-05-22 19:08:29",
"deleted_at": null
},
{
"id": 474,
"inventory_market_id": 7,
"phrase": "ada Michigan homes for sale",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:12",
"updated_at": "2018-05-22 19:08:29",
"deleted_at": null
},
{
"id": 476,
"inventory_market_id": 7,
"phrase": "homes for sale ada MI",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:12",
"updated_at": "2018-05-22 19:08:29",
"deleted_at": null
}
],
"state": {
"id": 22,
"name": "Michigan",
"abbreviation": "MI",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "26",
"assoc_press": "Mich.",
"standard_federal_region": "V",
"census_region": "2",
"census_region_name": "Midwest",
"census_division": "3",
"census_division_name": "East North Central",
"circuit_court": "6"
}
},
{
"id": 8,
"market": "adams township",
"state_id": 38,
"latitude": "40.717787",
"longitude": "-80.019956",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:09:13",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:09:13",
"deleted_at": null,
"inventory_phrases": [
{
"id": 548,
"inventory_market_id": 8,
"phrase": "adams township PA homes for sale",
"search_rate": 90,
"in_stock": 1,
"created_at": "2018-05-22 17:16:20",
"updated_at": "2018-05-22 19:08:37",
"deleted_at": null
},
{
"id": 551,
"inventory_market_id": 8,
"phrase": "homes for sale adams township PA",
"search_rate": 90,
"in_stock": 1,
"created_at": "2018-05-22 17:16:20",
"updated_at": "2018-05-22 19:08:38",
"deleted_at": null
},
{
"id": 553,
"inventory_market_id": 8,
"phrase": "homes for sale in adams township PA",
"search_rate": 90,
"in_stock": 1,
"created_at": "2018-05-22 17:16:20",
"updated_at": "2018-05-22 19:08:38",
"deleted_at": null
}
],
"state": {
"id": 38,
"name": "Pennsylvania",
"abbreviation": "PA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "42",
"assoc_press": "Pa.",
"standard_federal_region": "III",
"census_region": "1",
"census_region_name": "Northeast",
"census_division": "2",
"census_division_name": "Mid-Atlantic",
"circuit_court": "3"
}
},
{
"id": 9,
"market": "addison",
"state_id": 43,
"latitude": "32.961790",
"longitude": "-96.829169",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:09:13",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:09:13",
"deleted_at": null,
"inventory_phrases": [
{
"id": 633,
"inventory_market_id": 9,
"phrase": "addison houses",
"search_rate": 2900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:30",
"updated_at": "2018-05-22 19:08:46",
"deleted_at": null
},
{
"id": 636,
"inventory_market_id": 9,
"phrase": "houses in addison",
"search_rate": 2900,
"in_stock": 1,
"created_at": "2018-05-22 17:16:30",
"updated_at": "2018-05-22 19:08:46",
"deleted_at": null
},
{
"id": 612,
"inventory_market_id": 9,
"phrase": "addison real estate",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:27",
"updated_at": "2018-05-22 19:08:44",
"deleted_at": null
},
{
"id": 627,
"inventory_market_id": 9,
"phrase": "homes for sale addison Texas",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:16:29",
"updated_at": "2018-05-22 19:08:45",
"deleted_at": null
},
{
"id": 624,
"inventory_market_id": 9,
"phrase": "addison Texas homes for sale",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:16:29",
"updated_at": "2018-05-22 19:08:45",
"deleted_at": null
}
],
"state": {
"id": 43,
"name": "Texas",
"abbreviation": "TX",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "48",
"assoc_press": "Texas",
"standard_federal_region": "VI",
"census_region": "3",
"census_region_name": "South",
"census_division": "7",
"census_division_name": "West South Central",
"circuit_court": "5"
}
},
{
"id": 10,
"market": "affton",
"state_id": 25,
"latitude": "38.550608",
"longitude": "-90.333172",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:09:13",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:09:13",
"deleted_at": null,
"inventory_phrases": [
{
"id": 698,
"inventory_market_id": 10,
"phrase": "affton MO homes for sale",
"search_rate": 390,
"in_stock": 1,
"created_at": "2018-05-22 17:16:37",
"updated_at": "2018-05-22 19:08:53",
"deleted_at": null
},
{
"id": 699,
"inventory_market_id": 10,
"phrase": "affton Missouri homes for sale",
"search_rate": 390,
"in_stock": 1,
"created_at": "2018-05-22 17:16:37",
"updated_at": "2018-05-22 19:08:53",
"deleted_at": null
},
{
"id": 701,
"inventory_market_id": 10,
"phrase": "homes for sale affton MO",
"search_rate": 390,
"in_stock": 1,
"created_at": "2018-05-22 17:16:37",
"updated_at": "2018-05-22 19:08:53",
"deleted_at": null
},
{
"id": 702,
"inventory_market_id": 10,
"phrase": "homes for sale affton Missouri",
"search_rate": 390,
"in_stock": 1,
"created_at": "2018-05-22 17:16:37",
"updated_at": "2018-05-22 19:08:53",
"deleted_at": null
},
{
"id": 703,
"inventory_market_id": 10,
"phrase": "homes for sale in affton MO",
"search_rate": 390,
"in_stock": 1,
"created_at": "2018-05-22 17:16:37",
"updated_at": "2018-05-22 19:08:53",
"deleted_at": null
}
],
"state": {
"id": 25,
"name": "Missouri",
"abbreviation": "MO",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "29",
"assoc_press": "Mo.",
"standard_federal_region": "VII",
"census_region": "2",
"census_region_name": "Midwest",
"census_division": "4",
"census_division_name": "West North Central",
"circuit_court": "8"
}
},
{
"id": 11,
"market": "agoura hills",
"state_id": 5,
"latitude": "34.153340",
"longitude": "-118.761676",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:09:13",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:09:13",
"deleted_at": null,
"inventory_phrases": [
{
"id": 775,
"inventory_market_id": 11,
"phrase": "agoura hills homes for sale",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:45",
"updated_at": "2018-05-22 19:09:01",
"deleted_at": null
},
{
"id": 780,
"inventory_market_id": 11,
"phrase": "homes for sale in agoura hills",
"search_rate": 590,
"in_stock": 1,
"created_at": "2018-05-22 17:16:46",
"updated_at": "2018-05-22 19:09:01",
"deleted_at": null
},
{
"id": 777,
"inventory_market_id": 11,
"phrase": "homes for sale agoura hills California",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:45",
"updated_at": "2018-05-22 19:09:01",
"deleted_at": null
},
{
"id": 774,
"inventory_market_id": 11,
"phrase": "agoura hills California homes for sale",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:45",
"updated_at": "2018-05-22 19:09:01",
"deleted_at": null
},
{
"id": 795,
"inventory_market_id": 11,
"phrase": "houses for sale in agoura hills",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:47",
"updated_at": "2018-05-22 19:09:03",
"deleted_at": null
}
],
"state": {
"id": 5,
"name": "California",
"abbreviation": "CA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "6",
"assoc_press": "Calif.",
"standard_federal_region": "IX",
"census_region": "4",
"census_region_name": "West",
"census_division": "9",
"census_division_name": "Pacific",
"circuit_court": "9"
}
},
{
"id": 12,
"market": "agua dulce",
"state_id": 5,
"latitude": "34.496382",
"longitude": "-118.325635",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:09:13",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:09:13",
"deleted_at": null,
"inventory_phrases": [
{
"id": 853,
"inventory_market_id": 12,
"phrase": "homes for sale in agua dulce CA",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:54",
"updated_at": "2018-05-22 19:09:09",
"deleted_at": null
},
{
"id": 848,
"inventory_market_id": 12,
"phrase": "agua dulce CA homes for sale",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:53",
"updated_at": "2018-05-22 19:09:08",
"deleted_at": null
},
{
"id": 849,
"inventory_market_id": 12,
"phrase": "agua dulce California homes for sale",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:53",
"updated_at": "2018-05-22 19:09:08",
"deleted_at": null
},
{
"id": 851,
"inventory_market_id": 12,
"phrase": "homes for sale agua dulce CA",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:53",
"updated_at": "2018-05-22 19:09:08",
"deleted_at": null
},
{
"id": 852,
"inventory_market_id": 12,
"phrase": "homes for sale agua dulce California",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:16:54",
"updated_at": "2018-05-22 19:09:09",
"deleted_at": null
}
],
"state": {
"id": 5,
"name": "California",
"abbreviation": "CA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "6",
"assoc_press": "Calif.",
"standard_federal_region": "IX",
"census_region": "4",
"census_region_name": "West",
"census_division": "9",
"census_division_name": "Pacific",
"circuit_court": "9"
}
},
{
"id": 13,
"market": "ahwatukee",
"state_id": 3,
"latitude": "33.312262",
"longitude": "-112.035714",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:13:00",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:13:00",
"deleted_at": null,
"inventory_phrases": [
{
"id": 930,
"inventory_market_id": 13,
"phrase": "homes for sale in ahwatukee",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:17:02",
"updated_at": "2018-05-22 19:12:10",
"deleted_at": null
},
{
"id": 925,
"inventory_market_id": 13,
"phrase": "ahwatukee homes for sale",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:17:02",
"updated_at": "2018-05-22 19:12:10",
"deleted_at": null
},
{
"id": 927,
"inventory_market_id": 13,
"phrase": "homes for sale ahwatukee Arizona",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:02",
"updated_at": "2018-05-22 19:12:10",
"deleted_at": null
},
{
"id": 923,
"inventory_market_id": 13,
"phrase": "ahwatukee AZ homes for sale",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:01",
"updated_at": "2018-05-22 19:12:10",
"deleted_at": null
},
{
"id": 924,
"inventory_market_id": 13,
"phrase": "ahwatukee Arizona homes for sale",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:01",
"updated_at": "2018-05-22 19:12:10",
"deleted_at": null
}
],
"state": {
"id": 3,
"name": "Arizona",
"abbreviation": "AZ",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "4",
"assoc_press": "Ariz.",
"standard_federal_region": "IX",
"census_region": "4",
"census_region_name": "West",
"census_division": "8",
"census_division_name": "Mountain",
"circuit_court": "9"
}
},
{
"id": 14,
"market": "airway heights",
"state_id": 47,
"latitude": "47.644611",
"longitude": "-117.593273",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:13:00",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:13:00",
"deleted_at": null,
"inventory_phrases": [
{
"id": 998,
"inventory_market_id": 14,
"phrase": "airway heights WA homes for sale",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:17:11",
"updated_at": "2018-05-22 19:12:18",
"deleted_at": null
},
{
"id": 999,
"inventory_market_id": 14,
"phrase": "airway heights Washington homes for sale",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:17:11",
"updated_at": "2018-05-22 19:12:18",
"deleted_at": null
},
{
"id": 1001,
"inventory_market_id": 14,
"phrase": "homes for sale airway heights WA",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:17:11",
"updated_at": "2018-05-22 19:12:18",
"deleted_at": null
},
{
"id": 1002,
"inventory_market_id": 14,
"phrase": "homes for sale airway heights Washington",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:17:11",
"updated_at": "2018-05-22 19:12:18",
"deleted_at": null
},
{
"id": 1003,
"inventory_market_id": 14,
"phrase": "homes for sale in airway heights WA",
"search_rate": 110,
"in_stock": 1,
"created_at": "2018-05-22 17:17:11",
"updated_at": "2018-05-22 19:12:18",
"deleted_at": null
}
],
"state": {
"id": 47,
"name": "Washington",
"abbreviation": "WA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "53",
"assoc_press": "Wash.",
"standard_federal_region": "X",
"census_region": "4",
"census_region_name": "West",
"census_division": "9",
"census_division_name": "Pacific",
"circuit_court": "9"
}
},
{
"id": 15,
"market": "akron",
"state_id": 35,
"latitude": "41.081445",
"longitude": "-81.519005",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:13:00",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:13:00",
"deleted_at": null,
"inventory_phrases": [
{
"id": 1077,
"inventory_market_id": 15,
"phrase": "homes for sale akron Ohio",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:19",
"updated_at": "2018-05-22 19:12:26",
"deleted_at": null
},
{
"id": 1074,
"inventory_market_id": 15,
"phrase": "akron Ohio homes for sale",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:18",
"updated_at": "2018-05-22 19:12:26",
"deleted_at": null
},
{
"id": 1073,
"inventory_market_id": 15,
"phrase": "akron OH homes for sale",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:18",
"updated_at": "2018-05-22 19:12:26",
"deleted_at": null
},
{
"id": 1076,
"inventory_market_id": 15,
"phrase": "homes for sale akron OH",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:19",
"updated_at": "2018-05-22 19:12:26",
"deleted_at": null
},
{
"id": 1078,
"inventory_market_id": 15,
"phrase": "homes for sale in akron OH",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:19",
"updated_at": "2018-05-22 19:12:26",
"deleted_at": null
}
],
"state": {
"id": 35,
"name": "Ohio",
"abbreviation": "OH",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "39",
"assoc_press": "Ohio",
"standard_federal_region": "V",
"census_region": "2",
"census_region_name": "Midwest",
"census_division": "3",
"census_division_name": "East North Central",
"circuit_court": "6"
}
},
{
"id": 16,
"market": "alabaster",
"state_id": 1,
"latitude": "33.244281",
"longitude": "-86.816377",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:13:00",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:13:00",
"deleted_at": null,
"inventory_phrases": [
{
"id": 1151,
"inventory_market_id": 16,
"phrase": "homes for sale alabaster AL",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:27",
"updated_at": "2018-05-22 19:12:36",
"deleted_at": null
},
{
"id": 1148,
"inventory_market_id": 16,
"phrase": "alabaster AL homes for sale",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:26",
"updated_at": "2018-05-22 19:12:35",
"deleted_at": null
},
{
"id": 1153,
"inventory_market_id": 16,
"phrase": "homes for sale in alabaster AL",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:27",
"updated_at": "2018-05-22 19:12:36",
"deleted_at": null
},
{
"id": 1149,
"inventory_market_id": 16,
"phrase": "alabaster Alabama homes for sale",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:26",
"updated_at": "2018-05-22 19:12:35",
"deleted_at": null
},
{
"id": 1152,
"inventory_market_id": 16,
"phrase": "homes for sale alabaster Alabama",
"search_rate": 1300,
"in_stock": 1,
"created_at": "2018-05-22 17:17:27",
"updated_at": "2018-05-22 19:12:36",
"deleted_at": null
}
],
"state": {
"id": 1,
"name": "Alabama",
"abbreviation": "AL",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "1",
"assoc_press": "Ala.",
"standard_federal_region": "IV",
"census_region": "3",
"census_region_name": "South",
"census_division": "6",
"census_division_name": "East South Central",
"circuit_court": "11"
}
},
{
"id": 17,
"market": "alachua",
"state_id": 9,
"latitude": "29.793814",
"longitude": "-82.494423",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:13:00",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:13:00",
"deleted_at": null,
"inventory_phrases": [
{
"id": 1228,
"inventory_market_id": 17,
"phrase": "homes for sale in alachua FL",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:34",
"updated_at": "2018-05-22 19:12:45",
"deleted_at": null
},
{
"id": 1224,
"inventory_market_id": 17,
"phrase": "alachua Florida homes for sale",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:34",
"updated_at": "2018-05-22 19:12:45",
"deleted_at": null
},
{
"id": 1223,
"inventory_market_id": 17,
"phrase": "alachua FL homes for sale",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:34",
"updated_at": "2018-05-22 19:12:45",
"deleted_at": null
},
{
"id": 1226,
"inventory_market_id": 17,
"phrase": "homes for sale alachua FL",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:34",
"updated_at": "2018-05-22 19:12:45",
"deleted_at": null
},
{
"id": 1227,
"inventory_market_id": 17,
"phrase": "homes for sale alachua Florida",
"search_rate": 480,
"in_stock": 1,
"created_at": "2018-05-22 17:17:34",
"updated_at": "2018-05-22 19:12:45",
"deleted_at": null
}
],
"state": {
"id": 9,
"name": "Florida",
"abbreviation": "FL",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "12",
"assoc_press": "Fla.",
"standard_federal_region": "IV",
"census_region": "3",
"census_region_name": "South",
"census_division": "5",
"census_division_name": "South Atlantic",
"circuit_court": "11"
}
},
{
"id": 18,
"market": "alachua county",
"state_id": 9,
"latitude": "29.657955",
"longitude": "-82.301773",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:13:00",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:13:00",
"deleted_at": null,
"inventory_phrases": [
{
"id": 1302,
"inventory_market_id": 18,
"phrase": "homes for sale alachua county Florida",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:17:42",
"updated_at": "2018-05-22 19:12:54",
"deleted_at": null
},
{
"id": 1303,
"inventory_market_id": 18,
"phrase": "homes for sale in alachua county FL",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:17:43",
"updated_at": "2018-05-22 19:12:54",
"deleted_at": null
},
{
"id": 1298,
"inventory_market_id": 18,
"phrase": "alachua county FL homes for sale",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:17:42",
"updated_at": "2018-05-22 19:12:53",
"deleted_at": null
},
{
"id": 1299,
"inventory_market_id": 18,
"phrase": "alachua county Florida homes for sale",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:17:42",
"updated_at": "2018-05-22 19:12:53",
"deleted_at": null
},
{
"id": 1301,
"inventory_market_id": 18,
"phrase": "homes for sale alachua county FL",
"search_rate": 320,
"in_stock": 1,
"created_at": "2018-05-22 17:17:42",
"updated_at": "2018-05-22 19:12:54",
"deleted_at": null
}
],
"state": {
"id": 9,
"name": "Florida",
"abbreviation": "FL",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "12",
"assoc_press": "Fla.",
"standard_federal_region": "IV",
"census_region": "3",
"census_region_name": "South",
"census_division": "5",
"census_division_name": "South Atlantic",
"circuit_court": "11"
}
},
{
"id": 19,
"market": "alafaya",
"state_id": 9,
"latitude": "28.564100",
"longitude": "-81.211400",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:17:29",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:17:29",
"deleted_at": null,
"inventory_phrases": [],
"state": {
"id": 9,
"name": "Florida",
"abbreviation": "FL",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "12",
"assoc_press": "Fla.",
"standard_federal_region": "IV",
"census_region": "3",
"census_region_name": "South",
"census_division": "5",
"census_division_name": "South Atlantic",
"circuit_court": "11"
}
},
{
"id": 20,
"market": "alameda",
"state_id": 5,
"latitude": "37.765207",
"longitude": "-122.241636",
"inventory_phrases_in_stock": 75,
"inventory_phrase_rates_updated_at": "2018-05-22 19:17:29",
"created_at": "2018-05-17 21:06:03",
"updated_at": "2018-05-22 19:17:29",
"deleted_at": null,
"inventory_phrases": [
{
"id": 1455,
"inventory_market_id": 20,
"phrase": "homes for sale in alameda",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:17:59",
"updated_at": "2018-05-22 19:16:49",
"deleted_at": null
},
{
"id": 1450,
"inventory_market_id": 20,
"phrase": "alameda homes for sale",
"search_rate": 1000,
"in_stock": 1,
"created_at": "2018-05-22 17:17:58",
"updated_at": "2018-05-22 19:16:49",
"deleted_at": null
},
{
"id": 1452,
"inventory_market_id": 20,
"phrase": "homes for sale alameda California",
"search_rate": 880,
"in_stock": 1,
"created_at": "2018-05-22 17:17:59",
"updated_at": "2018-05-22 19:16:49",
"deleted_at": null
},
{
"id": 1448,
"inventory_market_id": 20,
"phrase": "alameda CA homes for sale",
"search_rate": 880,
"in_stock": 1,
"created_at": "2018-05-22 17:17:58",
"updated_at": "2018-05-22 19:16:48",
"deleted_at": null
},
{
"id": 1449,
"inventory_market_id": 20,
"phrase": "alameda California homes for sale",
"search_rate": 880,
"in_stock": 1,
"created_at": "2018-05-22 17:17:58",
"updated_at": "2018-05-22 19:16:49",
"deleted_at": null
}
],
"state": {
"id": 5,
"name": "California",
"abbreviation": "CA",
"country": "USA",
"type": "state",
"sort": 10,
"status": "current",
"occupied": "occupied",
"notes": "",
"fips_state": "6",
"assoc_press": "Calif.",
"standard_federal_region": "IX",
"census_region": "4",
"census_region_name": "West",
"census_division": "9",
"census_division_name": "Pacific",
"circuit_court": "9"
}
}
]
};


let map;
function initMap() {
  let centerLat = marketJSON.markets[0].latitude;
  let centerLong = marketJSON.markets[0].longitude;
  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 5,
    center: new google.maps.LatLng(centerLat, centerLong),
    mapTypeId: 'roadmap'
  });
}

function getMarkets(centerLat, centerLong){
  let centerLatLng = new google.maps.LatLng(centerLat, centerLong);
  //map.setCenter(centerLatLng);
  //map.setZoom(5);
  let marketArray = "API call here"
  addMarkers(marketArray);

}

function addMarkers(marketArray){
  let infoWindow = new google.maps.InfoWindow();
  let cityCircle = null;
  let markerArray = [];
  let latArray = [];
  let longArray = [];

  for (let i = 0; i < 1; i++) {
    let searchRates = [];
    let lat = marketJSON.markets[i].latitude;
    let long = marketJSON.markets[i].longitude;
    let latLng = new google.maps.LatLng(lat, long);
    let marker = new google.maps.Marker({
      position: latLng,
      map: map
    });
    markerArray.push(marker);
    latArray.push(lat);
    longArray.push(long);
    console.log(markerArray.length)
    for (let k = 0; k < marketJSON.markets[i].inventory_phrases.length; k++) {
      searchRates.push(marketJSON.markets[i].inventory_phrases[k].search_rate);
    }
    let leastSearch = Math.min(...searchRates);
    let mostSearch = Math.max(...searchRates);
    let market = marketJSON.markets[i].market.toLowerCase().replace(/([^a-z])([a-z])(?=[a-z]{2})|^([a-z])/g, function(_, g1, g2, g3) {
      return (typeof g1 === 'undefined') ? g3.toUpperCase() : g1 + g2.toUpperCase(); } );
    let info = `<div id="iw-container">
              <div class="iw-title">${market} / ${marketJSON.markets[i].state.abbreviation}</div>
              <div class="iw-content">
                <div class="iw-subTitle">Most searches: ${mostSearch}</div>
                <div class="iw-subTitle">Least searches: ${leastSearch}</div>
                <p>VISTA ALEGRE ATLANTIS, SA<br>3830-292 Ílhavo - Portugal<br>
                <br>Phone. +351 234 320 600<br>e-mail: geral@vaa.pt<br>www: www.myvistaalegre.com</p>
              </div>
              <button type="button" class="btn btn-primary btn-block">Add to Cart</button>
              </div>
              `;
    bindInfoWindow(marker, map, infoWindow, info);
  }
  let lowestLat = Math.min(...latArray);
  let lowestLong = Math.min(...longArray);
  let highestLat = Math.max(...latArray);
  let highestLong = Math.max(...longArray);
  setMapBound(lowestLat, lowestLong, highestLat, highestLong);

  map.addListener('dragend', function() {
    window.setTimeout(function() {
      if (cityCircle !== null) {
        cityCircle.setMap(null)
      }
      if (markerArray.length > 0) {
        console.log("market exists")
        for(let i=0; i<markerArray.length; i++){
          markerArray[i].setMap(null)
        }
      }
      let lat = marketJSON.markets[0].latitude;
      let long = marketJSON.markets[0].longitude;
      let latLng = new google.maps.LatLng(lat, long);
      let marker = new google.maps.Marker({
        position: latLng,
        map: map
      });
      let center = getMapCenter(map);
      cityCircle = new google.maps.Circle({
        strokeColor: '#FF0000',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#FF0000',
        fillOpacity: 0.35,
        map: map,
        center: center,
        radius: 16093.4
      });
    }, 500)
  });

  google.maps.event.addListener(infoWindow, 'domready', function() {
   var iwOuter = $('.gm-style-iw');
   var iwCloseBtn = iwOuter.next();
   var iwBackground = iwOuter.prev();
   iwBackground.children(':nth-child(2)').css({'display' : 'none'});
   iwBackground.children(':nth-child(4)').css({'display' : 'none'});
   iwCloseBtn.css({
     opacity: '1', // by default the close button has an opacity of 0.7
     right: '36px', top: '9px', // button repositioning
     'border-radius': '1px', // circular effect
     'box-shadow': '0 0 5px #3990B9' // 3D effect to highlight the button
   });
  });
}

function setMapBound(lat,long,lat2,long2){
  let latLng = new google.maps.LatLng(lat, long);
  let latLng1 = new google.maps.LatLng(lat2, long2);
  var bounds = new google.maps.LatLngBounds();
  bounds.extend(latLng);
  bounds.extend(latLng1);
  if (bounds.getNorthEast().equals(bounds.getSouthWest())) {
    var extendPoint1  = new google.maps.LatLng(bounds.getNorthEast().lat() + 0.5, bounds.getNorthEast().lng() + 0.5);
    var extendPoint2  = new google.maps.LatLng(bounds.getNorthEast().lat() - 0.5, bounds.getNorthEast().lng() - 0.5);
    bounds.extend(extendPoint1);
    bounds.extend(extendPoint2);
  }
  map.fitBounds(bounds, 0);
}

function getMapCenter(map){
  return map.getCenter();
}

function bindInfoWindow(marker, map, infoWindow, info) {
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(info);
    infoWindow.open(map, marker);
    marker.setAnimation(google.maps.Animation.BOUNCE);
  });
}
